{"paragraphs":[{"text":"%pyspark\nimport sys\nsys.argv=[\"mysql2s3-dynamic-mapping.py\",\"--JOB_NAME\",\"MySQL2S3-Dynamic\",\"--TempDir\",\"s3://<bucket>/temp\", \"--TABLE_NAME\",\"customer_site\", \"--DATABASE_NAME\",\"mysqldb\"]","user":"admin","dateUpdated":"2018-08-28T21:37:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535490719796_159214955","id":"20180828-211159_574670969","dateCreated":"2018-08-28T21:11:59+0000","dateStarted":"2018-08-28T21:37:27+0000","dateFinished":"2018-08-28T21:37:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7777"},{"text":"%pyspark\nimport sys,boto3\nfrom awsglue.transforms import *\nfrom awsglue.utils import getResolvedOptions\nfrom pyspark.context import SparkContext\nfrom awsglue.context import GlueContext\nfrom awsglue.job import Job\n","user":"admin","dateUpdated":"2018-08-28T21:37:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535490761546_1462036027","id":"20180828-211241_1141867131","dateCreated":"2018-08-28T21:12:41+0000","dateStarted":"2018-08-28T21:37:29+0000","dateFinished":"2018-08-28T21:37:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7778"},{"text":"%pyspark\nargs = getResolvedOptions(sys.argv, ['JOB_NAME','TABLE_NAME','DATABASE_NAME'])\n\nsc=sc if 'sc' in vars() else SparkContext()\nglueContext = GlueContext(sc)\nspark = glueContext.spark_session\njob = Job(glueContext)\njob.init(args['JOB_NAME'], args)","user":"admin","dateUpdated":"2018-08-28T21:37:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535490983217_2084481482","id":"20180828-211623_717203328","dateCreated":"2018-08-28T21:16:23+0000","dateStarted":"2018-08-28T21:37:31+0000","dateFinished":"2018-08-28T21:37:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7779"},{"text":"%pyspark\ndatabase_name = args['DATABASE_NAME']\ntable_name=args['TABLE_NAME']\n\n#read data from Mysql. Optionally you can add filters to say filter for records for today.\ndatasource0 = glueContext.create_dynamic_frame.from_catalog(database = database_name, table_name = table_name, transformation_ctx = \"datasource0\")\ndf=datasource0.toDF()\ndf.printSchema()","user":"admin","dateUpdated":"2018-08-28T21:37:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- SITE_ID: double (nullable = true)\n |-- CUST_ID: double (nullable = true)\n |-- ADDRESS: string (nullable = true)\n |-- CITY: string (nullable = true)\n |-- STATE: string (nullable = true)\n |-- COUNTRY: string (nullable = true)\n |-- PHONE: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1535490780488_43482156","id":"20180828-211300_263329400","dateCreated":"2018-08-28T21:13:00+0000","dateStarted":"2018-08-28T21:37:36+0000","dateFinished":"2018-08-28T21:37:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7780"},{"text":"%pyspark\ns3_output_dir=\"s3://<bucket>/\"+database_name+\"/\"+table_name\n#coalesce to a single file and write to S3 in CSV. Optionally you can partition using date fields within the record.\n#df.coalesce(1).write.mode('append').parquet(s3_output_dir)\ndf.coalesce(1).write.mode('append').csv(s3_output_dir,header=True)\njob.commit()","user":"admin","dateUpdated":"2018-08-28T21:37:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535490963381_1191617202","id":"20180828-211603_1403566104","dateCreated":"2018-08-28T21:16:03+0000","dateStarted":"2018-08-28T21:37:39+0000","dateFinished":"2018-08-28T21:37:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7781"},{"text":"%pyspark\n","user":"admin","dateUpdated":"2018-08-28T21:36:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535491647640_-890630165","id":"20180828-212727_167812429","dateCreated":"2018-08-28T21:27:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7782"}],"name":"MySQL2S3-DynamicMapping","id":"2DN8KCCWR","angularObjects":{"2CRE5X63N:shared_process":[],"2CQZ9JC8F:shared_process":[],"2CNAPD13W:shared_process":[],"2CRC324G8:existing_process":[],"2CQ1X8PFU:shared_process":[],"2CNFC7TNE:shared_process":[],"2CMQ2EHTE:shared_process":[],"2CQUCJVJA:shared_process":[],"2CQY3SUDK:shared_process":[],"2CNA37GFQ:shared_process":[],"2CPH9H73W:shared_process":[],"2CR2XFEE3:shared_process":[],"2CQ9YVF7W:shared_process":[],"2CP1P36EU:shared_process":[],"2CMR9MKCE:shared_process":[],"2CR2YZBFW:shared_process":[],"2CPJK4U6W:shared_process":[],"2CR2Z9UR2:shared_process":[],"2CPQWHWM3:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}
